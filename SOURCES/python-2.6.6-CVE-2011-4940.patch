diff -up Python-2.6.6/Lib/SimpleHTTPServer.py.CVE-2011-4940 Python-2.6.6/Lib/SimpleHTTPServer.py
--- Python-2.6.6/Lib/SimpleHTTPServer.py.CVE-2011-4940	2008-07-06 17:34:39.000000000 -0400
+++ Python-2.6.6/Lib/SimpleHTTPServer.py	2012-03-23 16:09:37.916587841 -0400
@@ -15,6 +15,7 @@ import posixpath
 import BaseHTTPServer
 import urllib
 import cgi
+import sys
 import shutil
 import mimetypes
 try:
@@ -131,7 +132,8 @@ class SimpleHTTPRequestHandler(BaseHTTPS
         length = f.tell()
         f.seek(0)
         self.send_response(200)
-        self.send_header("Content-type", "text/html")
+        encoding = sys.getfilesystemencoding()
+        self.send_header("Content-type", "text/html; charset=%s" % encoding)
         self.send_header("Content-Length", str(length))
         self.end_headers()
         return f
